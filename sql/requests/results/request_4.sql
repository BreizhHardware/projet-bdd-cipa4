-- Query 4
SELECT
    m.marque,
    COUNT(Id_installation) AS Nb_installation,
    AVG(puissance_crete) AS puissance_moy,
    MIN(puissance_crete) AS puissance_min,
    MAX(puissance_crete) AS puissance_max,
    ROUND(AVG(i.surface), 2) AS surface_moyenne
FROM installation i
         JOIN onduleur o ON o.Id_onduleur= i.Id_onduleur
         JOIN marque m ON m.id_marque = o.id_marque
GROUP BY m.marque
ORDER BY Nb_installation DESC
LIMIT 100;
-- Result
           marque           | nb_installation |     puissance_moy      | puissance_min | puissance_max | surface_moyenne 
----------------------------+-----------------+------------------------+---------------+---------------+-----------------
 SMA                        |            8119 |  4734.6002473716759431 |             0 |        686000 |           39.66
 FRONIUS                    |            1723 |  4257.8359603035610041 |           600 |        258300 |           31.36
 SPUTNIK                    |            1613 |  4590.4151646985705407 |           200 |        243000 |           43.61
 ENPHASE ENERGY             |            1333 |  3545.1708238851095994 |             0 |         11500 |           23.16
 POWER-ONE                  |            1278 |  4626.1366508688783570 |             0 |        118800 |           34.02
 MASTERVOLT                 |            1065 |  3729.2507122507122507 |           176 |        132312 |           29.23
 SCHNEIDER ELECTRIC         |             832 |  4250.7083854818523154 |           120 |        874650 |        10111.81
 APS - APSYSTEMS            |             451 |  2975.8943820224719101 |           106 |         18000 |           20.97
 SOLAREDGE                  |             426 |  6341.0094117647058824 |             0 |         99750 |           38.66
 KACO                       |             359 |  8441.4034090909090909 |           378 |        203400 |           59.55
 PHOTOWATT                  |             298 |  3732.1879194630872483 |             0 |         58190 |           32.00
 CONERGY                    |             270 |  3253.2835820895522388 |             0 |         26640 |           25.43
 KOSTAL                     |             261 |  6472.1867704280155642 |          1200 |        100000 |           44.79
 TENESOL                    |             247 |  5202.2032520325203252 |           110 |        300000 |           47.09
 PAS_DANS_LA_LISTE_ONDULEUR |             227 |  6380.4846153846153846 |           141 |        100050 |           42.83
 DELTA ENERGY               |             205 |  3874.1708542713567839 |          1480 |        105800 |           27.44
 DANFOSS                    |             201 |  6396.2060301507537688 |           185 |        107625 |           50.58
 DIEHL AKO                  |             167 |  4435.1017964071856287 |           960 |         99220 |           32.83
 ABB                        |             157 |  4931.6687898089171975 |           141 |         99840 |           36.75
 SCHUCO                     |             153 |  2921.1973684210526316 |           960 |         12800 |           23.98
 EFFEKTA                    |             137 |  3460.0787401574803150 |           100 |          9000 |           38.84
 INGETEAM                   |             130 |  4069.8800000000000000 |          1320 |        105600 |           50.34
 POWERSTOC                  |             121 |  2927.6583333333333333 |           150 |          9000 |           24.11
 SOLARMAX                   |             118 |  3956.8956521739130435 |           141 |         72680 |           29.31
 SUNPOWER                   |             108 |  3744.5140186915887850 |           576 |         15500 |           45.84
 STECA                      |             104 |  3043.8217821782178218 |           576 |         36000 |           21.05
 OMNIK                      |             100 |  2990.4897959183673469 |           220 |          9000 |           19.63
 SOLARSTOCC                 |              94 |  2807.7978723404255319 |           205 |         10416 |           22.43
 EATON CORPORATION          |              93 |  3488.9770114942528736 |           216 |         11250 |           23.81
 HOYMILES                   |              88 |  1852.6136363636363636 |           300 |          6000 |           13.72
 SOLAX                      |              82 |  3424.5802469135802469 |           555 |          9000 |           22.61
 SOLAIRE DIRECT             |              81 |  3191.1250000000000000 |          1728 |         21500 |           23.85
 BOURGEOISGLOBAL            |              67 |  3629.7014925373134328 |           740 |         12300 |           24.96
 GROWATT                    |              65 |  3434.6031746031746032 |           780 |         13600 |           33.09
 SOLAR                      |              60 |  3803.1000000000000000 |           300 |         35910 |           26.93
 SUNNY SWISS                |              54 |  3683.3269230769230769 |             0 |         37950 |           27.70
 HUAWEI                     |              45 |     19821.818181818182 |           400 |         99840 |          157.07
 WURTH SOLAR                |              43 |  2874.8837209302325581 |           920 |          5700 |           28.30
 AUNILEC                    |              37 |  2814.3888888888888889 |          1485 |          6000 |           20.11
 WKS                        |              37 |  3468.1944444444444444 |           920 |         10000 |           19.46
 AINELEC                    |              34 |  3535.0294117647058824 |           540 |         27690 |           24.53
 SUNWAYS                    |              33 |  3741.7187500000000000 |          2100 |         11400 |           27.12
 GENERAL ELECTRIC           |              32 |  3872.3333333333333333 |          2090 |         32400 |           25.78
 AEG                        |              31 |  2917.2413793103448276 |          1100 |          6720 |           30.03
 AERO SHARP                 |              30 |  2745.8000000000000000 |          1040 |          3120 |           26.43
 SOLAXPOWER                 |              28 |  2655.7857142857142857 |           990 |          6000 |           17.46
 SIEMENS                    |              28 |     12333.571428571429 |           688 |        189420 |           98.89
 SOCOMEC                    |              26 |  3199.4166666666666667 |          2100 |          8820 |          106.31
 IBC SOLAR                  |              25 |  7287.2083333333333333 |          1540 |         64680 |           57.92
 ENECSYS                    |              25 |  4842.9600000000000000 |           480 |          9000 |           36.72
 MITSUBISHI                 |              25 |  2897.8695652173913043 |           840 |          5400 |           23.92
 VICTRON                    |              23 |  3696.8181818181818182 |           260 |         21900 |           25.00
 AXUN                       |              19 |  9359.3157894736842105 |          1600 |         97240 |           62.00
 ACE                        |              17 |  9432.8000000000000000 |           170 |        124410 |           52.06
 DURALUX                    |              15 |  2845.0000000000000000 |          1410 |          5880 |           20.00
 SOLARWORLD                 |              15 |  3387.8000000000000000 |           510 |          8960 |           24.60
 AURORA                     |              15 |  3030.7333333333333333 |           900 |          6000 |           21.60
 THOMSON                    |              14 |  4304.6153846153846154 |          1320 |          9000 |           27.14
 SOFAR SOLAR                |              14 |  3073.2142857142857143 |          1155 |          6570 |           21.14
 INFOSEC                    |              14 |  3343.4166666666666667 |          1440 |          8820 |           21.43
 SUNGROW                    |              13 |     11853.750000000000 |          2760 |        101250 |           51.38
 TOTAL ENERGIE              |              13 |  4196.9230769230769231 |           660 |         13860 |           34.92
 AECONVERSION               |              13 |  1047.6153846153846154 |           141 |          3000 |           10.38
 SANYO                      |              13 |  3226.0000000000000000 |          2100 |          6000 |           20.54
 SOLAR-FABRIK               |              12 |     19664.333333333333 |          2580 |        161007 |          122.08
 AIXCON                     |              10 |  4703.3333333333333333 |           900 |         19920 |          137.30
 KINGLONG                   |              10 |  2746.0000000000000000 |           500 |          3120 |           17.50
 REFU                       |               9 |     57303.888888888889 |          9000 |        154980 |          476.56
 MPP SOLAR                  |               8 |  3110.6250000000000000 |          2625 |          3600 |           19.38
 SOLUTRONIC                 |               8 |  2331.4285714285714286 |           600 |          3240 |           18.50
 UBBINK                     |               8 |  2811.8750000000000000 |          2100 |          4440 |           21.88
 ENVERTECH                  |               8 |  1348.5714285714285714 |           750 |          3000 |            6.50
 GRID TIE INVERTER          |               7 |   828.5714285714285714 |           600 |          1000 |            4.57
 BP SOLAR / TRACE           |               7 |  6642.0000000000000000 |           960 |         23400 |           28.71
 BEON ENERGY                |               7 |   824.1666666666666667 |           465 |          1280 |            3.86
 SUNSET                     |               7 |  2295.0000000000000000 |          1200 |          3000 |           18.29
 IBC SOLAR AG               |               6 |  9820.0000000000000000 |          2100 |         24150 |           73.17
 SOLON AG                   |               6 |  3205.0000000000000000 |          2940 |          4480 |           22.17
 GINLONG                    |               6 |  3180.3333333333333333 |           320 |          5920 |           19.33
 SUNSYS                     |               6 |  2495.0000000000000000 |          1050 |          3000 |           18.33
 CARLO GAVAZZI              |               6 |  4146.0000000000000000 |          2880 |          8930 |           32.67
 GE ENERGY                  |               6 |  2959.0000000000000000 |           940 |          7920 |           20.83
 SOLADIN                    |               6 |  2186.0000000000000000 |          1250 |          2960 |           19.50
 EVERSOL                    |               5 |  7042.0000000000000000 |          1760 |         18000 |           49.00
 IMEON                      |               5 |  5130.0000000000000000 |          2250 |          9000 |           28.20
 SUNTECHNICS                |               5 |  3060.0000000000000000 |          2000 |          4000 |          102.60
 VOLTEA                     |               5 |  1798.0000000000000000 |           470 |          2960 |           12.20
 BAHRMANN                   |               5 |     20565.000000000000 |           180 |         95000 |          213.80
 SHARP                      |               5 |     20649.000000000000 |          1800 |         93420 |           13.00
 STUDER                     |               5 |  2654.0000000000000000 |           750 |          4800 |           13.60
 ASP                        |               5 |  2406.0000000000000000 |          1110 |          4500 |           15.20
 VOLTRONIC POWER            |               5 |  3778.0000000000000000 |          1460 |          6300 |           20.40
 SAMIL POWER                |               5 |  3798.4000000000000000 |          2500 |          6000 |           26.20
 INVOLAR                    |               5 |  3383.5000000000000000 |           810 |          8604 |           21.40
 TALESUN                    |               5 |  2684.0000000000000000 |           600 |          4000 |           13.60
 ALPHA                      |               4 |  4248.7500000000000000 |          1440 |          8910 |           18.75
 ATERSA                     |               4 | 10114.7500000000000000 |           500 |         34188 |           84.00
 NEDAP ENERGY               |               4 |  2367.5000000000000000 |           940 |          3000 |           20.25
 EVERLIGHT                  |               4 |  5280.0000000000000000 |           480 |         17000 |           38.00
 POWERCOM                   |               4 |  4016.2500000000000000 |          2590 |          7700 |           27.25
(100 rows)

