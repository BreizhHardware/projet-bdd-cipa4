-- Query 5
SELECT
    i.orientation,
    COUNT(Id_installation) AS Nb_installation,
    SUM(puissance_crete) AS puissance_totale,
    CASE
        WHEN i.pente < 10 THEN '0-10°'
        WHEN i.pente BETWEEN 10 AND 20 THEN '10-20°'
        WHEN i.pente BETWEEN 20 AND 30 THEN '20-30°'
        ELSE '>30°'
        END AS tranche_pente
FROM Installation i
GROUP BY i.orientation, tranche_pente
ORDER BY i.orientation, tranche_pente
LIMIT 100;
-- Result
 orientation | nb_installation | puissance_totale | tranche_pente 
-------------+-----------------+------------------+---------------
        -180 |              25 |            56309 | 0-10°
        -180 |              96 |           894899 | 10-20°
        -180 |              88 |           403147 | 20-30°
        -180 |              77 |          1328510 | >30°
        -175 |               1 |             2000 | 0-10°
        -175 |              13 |            40153 | 10-20°
        -175 |               7 |            52110 | 20-30°
        -175 |               6 |            18310 | >30°
        -170 |              13 |            40350 | 10-20°
        -170 |               6 |            16570 | 20-30°
        -170 |              14 |            32110 | >30°
        -165 |               8 |           161501 | 10-20°
        -165 |               9 |            23525 | 20-30°
        -165 |               7 |            18140 | >30°
        -160 |              10 |            32570 | 10-20°
        -160 |               5 |            13340 | 20-30°
        -160 |               7 |            18290 | >30°
        -155 |               2 |             8010 | 10-20°
        -155 |               4 |            21100 | 20-30°
        -155 |               5 |            20420 | >30°
        -150 |               1 |             2800 | 0-10°
        -150 |               7 |            71206 | 10-20°
        -150 |               4 |            12140 | 20-30°
        -150 |               8 |            19681 | >30°
        -145 |               4 |            17370 | 10-20°
        -145 |               3 |             8756 | 20-30°
        -145 |               4 |             9090 | >30°
        -140 |               1 |             2200 | 0-10°
        -140 |              11 |           120700 | 10-20°
        -140 |               5 |            15630 | 20-30°
        -140 |              10 |            37800 | >30°
        -135 |              11 |            76694 | 10-20°
        -135 |               5 |            17835 | 20-30°
        -135 |              10 |            35080 | >30°
        -130 |               1 |             2960 | 0-10°
        -130 |               4 |            10612 | 10-20°
        -130 |               4 |            12480 | 20-30°
        -130 |               3 |            14550 | >30°
        -125 |               1 |            13980 | 0-10°
        -125 |               2 |             5156 | 10-20°
        -125 |               4 |            12780 | 20-30°
        -125 |               4 |             8000 | >30°
        -120 |               1 |             2700 | 0-10°
        -120 |               7 |            15060 | 10-20°
        -120 |               4 |             3985 | 20-30°
        -120 |              13 |            49700 | >30°
        -115 |               7 |            22160 | 10-20°
        -115 |               6 |            15410 | >30°
        -110 |              12 |            34866 | 10-20°
        -110 |               3 |            11190 | 20-30°
        -110 |               7 |            14055 | >30°
        -105 |               2 |             4980 | 10-20°
        -105 |               5 |            19076 | >30°
        -100 |               1 |             4000 | 0-10°
        -100 |              17 |            87040 | 10-20°
        -100 |              19 |            63780 | 20-30°
        -100 |              11 |            28632 | >30°
         -95 |               1 |              165 | 0-10°
         -95 |              17 |            68135 | 10-20°
         -95 |              14 |            71881 | 20-30°
         -95 |               4 |            14420 | >30°
         -90 |              11 |            38484 | 0-10°
         -90 |             283 |          1301092 | 10-20°
         -90 |             166 |           593976 | 20-30°
         -90 |             143 |           404679 | >30°
         -85 |              35 |           327790 | 10-20°
         -85 |              27 |            96418 | 20-30°
         -85 |              26 |            88554 | >30°
         -80 |               1 |             2800 | 0-10°
         -80 |              84 |           275504 | 10-20°
         -80 |              29 |            97936 | 20-30°
         -80 |              43 |           145373 | >30°
         -75 |               1 |              378 | 0-10°
         -75 |              67 |           278746 | 10-20°
         -75 |              16 |            48950 | 20-30°
         -75 |              21 |            74573 | >30°
         -70 |              79 |           619370 | 10-20°
         -70 |              43 |           130675 | 20-30°
         -70 |              57 |           181444 | >30°
         -65 |               1 |             2520 | 0-10°
         -65 |              56 |           229340 | 10-20°
         -65 |              27 |            83051 | 20-30°
         -65 |              37 |           118924 | >30°
         -60 |             109 |           506669 | 10-20°
         -60 |              80 |           241072 | 20-30°
         -60 |              65 |           191429 | >30°
         -55 |               2 |             8820 | 0-10°
         -55 |              49 |           148996 | 10-20°
         -55 |              20 |            67420 | 20-30°
         -55 |              28 |            99698 | >30°
         -50 |               3 |            71060 | 0-10°
         -50 |              85 |           443819 | 10-20°
         -50 |              53 |           272222 | 20-30°
         -50 |              75 |           256700 | >30°
         -45 |              13 |            42609 | 0-10°
         -45 |             628 |          2903189 | 10-20°
         -45 |             460 |          1513160 | 20-30°
         -45 |             562 |          1800753 | >30°
         -40 |               2 |            12240 | 0-10°
         -40 |             161 |           746362 | 10-20°
(100 rows)

