-- Query 5
SELECT
    i.orientation,
    COUNT(Id_installation) AS Nb_installation,
    SUM(puissance_crete) AS puissance_totale,
    CASE
        WHEN i.pente < 10 THEN '0-10°'
        WHEN i.pente BETWEEN 10 AND 20 THEN '10-20°'
        WHEN i.pente BETWEEN 20 AND 30 THEN '20-30°'
        ELSE '>30°'
        END AS tranche_pente
FROM Installation i
GROUP BY i.orientation, tranche_pente
ORDER BY i.orientation, tranche_pente;
-- Result
 orientation | nb_installation | puissance_totale | tranche_pente 
-------------+-----------------+------------------+---------------
        -180 |              25 |            56309 | 0-10°
        -180 |              96 |           894899 | 10-20°
        -180 |              88 |           403147 | 20-30°
        -180 |              77 |          1328510 | >30°
        -175 |               1 |             2000 | 0-10°
        -175 |              13 |            40153 | 10-20°
        -175 |               7 |            52110 | 20-30°
        -175 |               6 |            18310 | >30°
        -170 |              13 |            40350 | 10-20°
        -170 |               6 |            16570 | 20-30°
        -170 |              14 |            32110 | >30°
        -165 |               8 |           161501 | 10-20°
        -165 |               9 |            23525 | 20-30°
        -165 |               7 |            18140 | >30°
        -160 |              10 |            32570 | 10-20°
        -160 |               5 |            13340 | 20-30°
        -160 |               7 |            18290 | >30°
        -155 |               2 |             8010 | 10-20°
        -155 |               4 |            21100 | 20-30°
        -155 |               5 |            20420 | >30°
        -150 |               1 |             2800 | 0-10°
        -150 |               7 |            71206 | 10-20°
        -150 |               4 |            12140 | 20-30°
        -150 |               8 |            19681 | >30°
        -145 |               4 |            17370 | 10-20°
        -145 |               3 |             8756 | 20-30°
        -145 |               4 |             9090 | >30°
        -140 |               1 |             2200 | 0-10°
        -140 |              11 |           120700 | 10-20°
        -140 |               5 |            15630 | 20-30°
        -140 |              10 |            37800 | >30°
        -135 |              11 |            76694 | 10-20°
        -135 |               5 |            17835 | 20-30°
        -135 |              10 |            35080 | >30°
        -130 |               1 |             2960 | 0-10°
        -130 |               4 |            10612 | 10-20°
        -130 |               4 |            12480 | 20-30°
        -130 |               3 |            14550 | >30°
        -125 |               1 |            13980 | 0-10°
        -125 |               2 |             5156 | 10-20°
        -125 |               4 |            12780 | 20-30°
        -125 |               4 |             8000 | >30°
        -120 |               1 |             2700 | 0-10°
        -120 |               7 |            15060 | 10-20°
        -120 |               4 |             3985 | 20-30°
        -120 |              13 |            49700 | >30°
        -115 |               7 |            22160 | 10-20°
        -115 |               6 |            15410 | >30°
        -110 |              12 |            34866 | 10-20°
        -110 |               3 |            11190 | 20-30°
        -110 |               7 |            14055 | >30°
        -105 |               2 |             4980 | 10-20°
        -105 |               5 |            19076 | >30°
        -100 |               1 |             4000 | 0-10°
        -100 |              17 |            87040 | 10-20°
        -100 |              19 |            63780 | 20-30°
        -100 |              11 |            28632 | >30°
         -95 |               1 |              165 | 0-10°
         -95 |              17 |            68135 | 10-20°
         -95 |              14 |            71881 | 20-30°
         -95 |               4 |            14420 | >30°
         -90 |              11 |            38484 | 0-10°
         -90 |             283 |          1301092 | 10-20°
         -90 |             166 |           593976 | 20-30°
         -90 |             143 |           404679 | >30°
         -85 |              35 |           327790 | 10-20°
         -85 |              27 |            96418 | 20-30°
         -85 |              26 |            88554 | >30°
         -80 |               1 |             2800 | 0-10°
         -80 |              84 |           275504 | 10-20°
         -80 |              29 |            97936 | 20-30°
         -80 |              43 |           145373 | >30°
         -75 |               1 |              378 | 0-10°
         -75 |              67 |           278746 | 10-20°
         -75 |              16 |            48950 | 20-30°
         -75 |              21 |            74573 | >30°
         -70 |              79 |           619370 | 10-20°
         -70 |              43 |           130675 | 20-30°
         -70 |              57 |           181444 | >30°
         -65 |               1 |             2520 | 0-10°
         -65 |              56 |           229340 | 10-20°
         -65 |              27 |            83051 | 20-30°
         -65 |              37 |           118924 | >30°
         -60 |             109 |           506669 | 10-20°
         -60 |              80 |           241072 | 20-30°
         -60 |              65 |           191429 | >30°
         -55 |               2 |             8820 | 0-10°
         -55 |              49 |           148996 | 10-20°
         -55 |              20 |            67420 | 20-30°
         -55 |              28 |            99698 | >30°
         -50 |               3 |            71060 | 0-10°
         -50 |              85 |           443819 | 10-20°
         -50 |              53 |           272222 | 20-30°
         -50 |              75 |           256700 | >30°
         -45 |              13 |            42609 | 0-10°
         -45 |             628 |          2903189 | 10-20°
         -45 |             460 |          1513160 | 20-30°
         -45 |             562 |          1800753 | >30°
         -40 |               2 |            12240 | 0-10°
         -40 |             161 |           746362 | 10-20°
         -40 |             106 |           364914 | 20-30°
         -40 |             170 |           544977 | >30°
         -35 |               2 |            99740 | 0-10°
         -35 |              86 |           350244 | 10-20°
         -35 |              57 |           200911 | 20-30°
         -35 |              76 |           270144 | >30°
         -30 |               3 |            70120 | 0-10°
         -30 |             214 |           996400 | 10-20°
         -30 |             138 |          1187922 | 20-30°
         -30 |             222 |           789864 | >30°
         -25 |               4 |            19110 | 0-10°
         -25 |             121 |           808336 | 10-20°
         -25 |              76 |           249634 | 20-30°
         -25 |             108 |           366176 | >30°
         -20 |               2 |             4990 | 0-10°
         -20 |             332 |          1486177 | 10-20°
         -20 |             174 |           885622 | 20-30°
         -20 |             233 |           773736 | >30°
         -15 |               4 |            11910 | 0-10°
         -15 |             204 |          1517661 | 10-20°
         -15 |             144 |           625545 | 20-30°
         -15 |             191 |           656402 | >30°
         -10 |               3 |             8075 | 0-10°
         -10 |             316 |          1997586 | 10-20°
         -10 |             203 |           901518 | 20-30°
         -10 |             283 |          1034516 | >30°
          -5 |               1 |             3200 | 0-10°
          -5 |             260 |          1925164 | 10-20°
          -5 |             206 |          1099986 | 20-30°
          -5 |             271 |           878449 | >30°
           0 |              65 |           841462 | 0-10°
           0 |            1917 |         12087315 | 10-20°
           0 |            1423 |          6822855 | 20-30°
           0 |            1758 |          6266030 | >30°
           5 |               9 |            37132 | 0-10°
           5 |             277 |          1597447 | 10-20°
           5 |             156 |           624960 | 20-30°
           5 |             248 |           813668 | >30°
          10 |               2 |             4500 | 0-10°
          10 |             342 |          2011909 | 10-20°
          10 |             169 |           829044 | 20-30°
          10 |             261 |           796922 | >30°
          15 |               5 |            23500 | 0-10°
          15 |             229 |          1429568 | 10-20°
          15 |             123 |           481509 | 20-30°
          15 |             183 |           659111 | >30°
          20 |               1 |             2970 | 0-10°
          20 |             364 |          1705500 | 10-20°
          20 |             186 |           838319 | 20-30°
          20 |             249 |           764405 | >30°
          25 |               2 |            16630 | 0-10°
          25 |             139 |           598452 | 10-20°
          25 |              69 |           227155 | 20-30°
          25 |              82 |           288246 | >30°
          30 |               4 |            61160 | 0-10°
          30 |             274 |          1124282 | 10-20°
          30 |             151 |           676640 | 20-30°
          30 |             211 |           693096 | >30°
          35 |               1 |             1980 | 0-10°
          35 |             112 |           456360 | 10-20°
          35 |              68 |           264157 | 20-30°
          35 |             102 |           385679 | >30°
          40 |               1 |             2750 | 0-10°
          40 |             206 |          1121806 | 10-20°
          40 |              96 |           751031 | 20-30°
          40 |             168 |           629165 | >30°
          45 |              12 |            21168 | 0-10°
          45 |             600 |          2799566 | 10-20°
          45 |             450 |          1521857 | 20-30°
          45 |             574 |          1879572 | >30°
          50 |              77 |           354950 | 10-20°
          50 |              66 |           186118 | 20-30°
          50 |              68 |           200490 | >30°
          55 |               3 |            21840 | 0-10°
          55 |              42 |           127154 | 10-20°
          55 |              19 |            65926 | 20-30°
          55 |              43 |           192680 | >30°
          60 |               1 |            19000 | 0-10°
          60 |             115 |           500269 | 10-20°
          60 |              57 |           193101 | 20-30°
          60 |              93 |           282652 | >30°
          65 |              32 |           101611 | 10-20°
          65 |              23 |           111028 | 20-30°
          65 |              29 |            93390 | >30°
          70 |               1 |             2450 | 0-10°
          70 |              85 |           484712 | 10-20°
          70 |              35 |           105872 | 20-30°
          70 |              52 |           149876 | >30°
          75 |              45 |           142702 | 10-20°
          75 |              24 |           104463 | 20-30°
          75 |              32 |           101874 | >30°
          80 |              63 |           268143 | 10-20°
          80 |              40 |           113063 | 20-30°
          80 |              46 |           132994 | >30°
          85 |               1 |             7500 | 0-10°
          85 |              42 |           155403 | 10-20°
          85 |              34 |           123535 | 20-30°
          85 |              25 |            78229 | >30°
          90 |               4 |            27840 | 0-10°
          90 |             214 |           961162 | 10-20°
          90 |             181 |           578165 | 20-30°
          90 |             184 |           776425 | >30°
          95 |               1 |             2800 | 0-10°
          95 |              15 |            41106 | 10-20°
          95 |               6 |            23492 | 20-30°
          95 |               9 |            36230 | >30°
         100 |              23 |           166108 | 10-20°
         100 |               7 |            17920 | 20-30°
         100 |               8 |            22380 | >30°
         105 |               8 |            28805 | 10-20°
         105 |               2 |             2970 | 20-30°
         105 |               3 |            12960 | >30°
         110 |               6 |            20100 | 10-20°
         110 |               4 |            12686 | 20-30°
         110 |               6 |            15160 | >30°
         115 |               4 |           118270 | 10-20°
         115 |               4 |             8880 | 20-30°
         120 |               4 |            13360 | 10-20°
         120 |               4 |            43080 | 20-30°
         120 |               5 |            20702 | >30°
         125 |               1 |             2960 | 10-20°
         130 |               1 |              260 | 0-10°
         130 |               8 |            24440 | 10-20°
         130 |               2 |             6080 | 20-30°
         130 |               2 |             9720 | >30°
         135 |               4 |            22940 | 10-20°
         135 |               1 |                  | 20-30°
         135 |               5 |            19656 | >30°
         140 |               5 |            21006 | 10-20°
         140 |               2 |             5940 | 20-30°
         140 |               3 |             7560 | >30°
         145 |               1 |                  | 10-20°
         145 |               1 |             2100 | 20-30°
         145 |               2 |             5036 | >30°
         150 |               1 |             2550 | 0-10°
         150 |               6 |            14370 | 10-20°
         150 |               1 |             3000 | 20-30°
         150 |               1 |             1620 | >30°
         155 |               1 |             3920 | 0-10°
         155 |               2 |             5770 | 10-20°
         155 |               3 |             7286 | 20-30°
         155 |               1 |                  | >30°
         160 |               9 |            20403 | 10-20°
         160 |               7 |            23100 | 20-30°
         160 |               4 |             7716 | >30°
         165 |               5 |            24029 | 10-20°
         165 |               4 |            10823 | 20-30°
         165 |               1 |             2100 | >30°
         170 |               5 |            15515 | 10-20°
         170 |               7 |            18005 | 20-30°
         175 |               7 |            19480 | 10-20°
         175 |               1 |             2880 | 20-30°
         180 |               6 |            41503 | 0-10°
         180 |              25 |           190070 | 10-20°
         180 |              32 |            97815 | 20-30°
         180 |              24 |            70100 | >30°
(256 rows)

